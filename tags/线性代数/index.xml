<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>çº¿æ€§ä»£æ•° on Eoin Lee's Blog</title><link>https://eoin.blog/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/</link><description>Recent content in çº¿æ€§ä»£æ•° on Eoin Lee's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Mon, 24 Jun 2024 00:00:00 +0800</lastBuildDate><atom:link href="https://eoin.blog/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€Œç¾é£Ÿå®¶ã€é¢˜è§£</title><link>https://eoin.blog/p/sol-luogu6772/</link><pubDate>Mon, 24 Jun 2024 00:00:00 +0800</pubDate><guid>https://eoin.blog/p/sol-luogu6772/</guid><description>&lt;ul>
&lt;li>å‡ºå¤„ï¼šNOI 2020&lt;/li>
&lt;li>é¢˜é¢ä¸è¯„æµ‹åœ°å€ï¼š&lt;a class="link" href="https://www.luogu.com.cn/problem/P6772" target="_blank" rel="noopener"
>æ´›è°· P6772&lt;/a> &amp;amp; &lt;a class="link" href="https://loj.ac/p/3339" target="_blank" rel="noopener"
>LibreOJ #3339&lt;/a>&lt;/li>
&lt;li>å‚è€ƒé¢˜è§£ï¼š&lt;a class="link" href="https://www.cnblogs.com/Plozia/p/16773840.html" target="_blank" rel="noopener"
>By Plozia&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="æš´åŠ›éƒ¨åˆ†åˆ†">æš´åŠ›éƒ¨åˆ†åˆ†
&lt;/h2>&lt;p>å…ˆè€ƒè™‘æœ´ç´ åšæ³•å¦‚ä½•å®ç°ã€‚æ ¹æ®é¢˜ç›®çš„è®¾é—®æ–¹å¼å¯ä»¥å‘ç°ï¼Œè¿™é“é¢˜éœ€è¦ç”¨åˆ°åŠ¨æ€è§„åˆ’è¿›è¡Œè§£å†³ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è®¾è®¡è¿™æ ·ä¸€ä¸ªçŠ¶æ€ï¼š$f_{t, v}$ï¼Œå®ƒè¡¨ç¤ºç¬¬ $t$ å¤©èµ°åˆ°äº†åŸå¸‚ $v$ æ—¶æ‰€èƒ½æŒæœ‰çš„æœ€å¤§æ„‰æ‚¦å€¼ã€‚ä»¤å›¾ä¸­èµ·ç‚¹ä¸º $u$ã€ç»ˆç‚¹ä¸º $v$ã€è€—æ—¶ä¸º $w$ çš„æœ‰å‘è¾¹ä¸º $(u, v, w)$ï¼Œåˆ™è¯¥çŠ¶æ€çš„è½¬ç§»æ»¡è¶³ï¼š&lt;/p>
&lt;p>$$
f_{t, v} = \max_{(u, v, w) \in E} \left\lbrace f_{t - w, u} \right\rbrace + c_v + \text{fest}_{t, v}
$$&lt;/p>
&lt;p>å…¶ä¸­ï¼Œ$\text{fest}_{t, v}$ ä¸ºåœ¨ç¬¬ $t$ å¤©åŸå¸‚ $v$ æ‰€ä¸¾åŠçš„ç¾é£ŸèŠ‚çš„åŠ æˆã€‚è‹¥è¿™ä¸€å¤©åœ¨è¿™åº§åŸå¸‚æ²¡æœ‰ç¾é£ŸèŠ‚ä¸¾åŠï¼Œè¯¥å€¼ç­‰äº $0$ã€‚å½“ç„¶ï¼Œå®é™…ç¼–ç æ—¶è¿˜è¦è€ƒè™‘ $i - w$ ä¸å°äº $1$ ç­‰ç­‰é—®é¢˜ï¼Œè¿™é‡Œå°±ä¸è¯¦è¿°äº†ã€‚ä»…ä»…æ˜¯è¿™æ ·æš´åŠ›çš„ $\mathcal{O}\left (Tn\right )$ å¤æ‚åº¦çš„ DPï¼Œä¹Ÿå¯ä»¥æ‹¿åˆ° 40 åˆ†ï¼Œè¿™å……åˆ†è¯´æ˜äº†å¥½å¥½æ‰“éƒ¨åˆ†åˆ†çš„é‡è¦æ€§ ğŸ˜®&lt;/p>
&lt;h2 id="çŸ©é˜µä¼˜åŒ–çš„å¼•å…¥">çŸ©é˜µä¼˜åŒ–çš„å¼•å…¥
&lt;/h2>&lt;p>å‡è®¾ç°åœ¨æ‰€æœ‰è¾¹çš„è¾¹æƒ $w$ å‡ä¸º $1$ï¼Œä¸”æš‚æ—¶ä¸è€ƒè™‘ç¾é£ŸèŠ‚çš„å½±å“ï¼Œå³ $k = 0$ã€‚é‚£ä¹ˆåŸé—®é¢˜ç®€åŒ–ä¸ºï¼šåœ¨ä¸€ä¸ª $n$ ç‚¹ $m$ è¾¹çš„å›¾ä¸­ï¼Œæ°å¥½ç»è¿‡ $p$ æ¡è¾¹çš„æœ€é•¿è·¯ã€‚æ²¿ç”¨æ­¤å‰çš„è½¬ç§»ï¼Œæˆ‘ä»¬æœ‰ï¼š&lt;/p>
&lt;p>$$
\begin{aligned}
f_{t, v} &amp;amp;= \max \left\lbrace f_{t - w, u} \right\rbrace + c_v + \text{fest} _ {t, v} \newline
&amp;amp;= \max \left\lbrace f_{t - 1, u} \right\rbrace + c_v \newline
&amp;amp;= \max \left\lbrace f_{t - 1, u} + c_v \right\rbrace
\end{aligned}
$$&lt;/p>
&lt;p>è¿™é‡Œçš„ $c_v$ å¯çœ‹ä½œæ˜¯æ¯ä¸ªç‚¹çš„ç‚¹æƒï¼Œè€ƒè™‘å°†å…¶è½¬åŒ–ä¸ºè¾¹æƒï¼Œä»¤ $d_{u, v}$ è¡¨ç¤ºèµ·ç‚¹ä¸º $u$ã€ç»ˆç‚¹ä¸º $v$ çš„è¾¹ä¸­ï¼Œç»ˆç‚¹ $v$ çš„æ„‰æ‚¦å€¼ $c_v$ã€‚é‚£ä¹ˆä¸Šå¼å°±å¯ä»¥å†™ä¸º&lt;/p>
&lt;p>$$
f_{t, v} = \max\left\lbrace f_{t - 1, u} + d_{u, v} \right\rbrace
$$&lt;/p>
&lt;p>ä½ å¯èƒ½ä¼šå‘ç°ï¼Œè¿™æ ·çš„å½¢å¼ä¸çŸ©é˜µä¹˜æ³•æœ‰äº›ç›¸ä¼¼â€”â€”ä¸¤ä¸ª $f$ çš„ç¬¬ä¸€é¡¹éƒ½ä¸ $t$ ç›¸å…³ï¼Œåé¢çš„ $f$ çš„ç¬¬äºŒé¡¹ä¸ $d$ çš„ç¬¬ä¸€é¡¹ç›¸åŒï¼Œå‰é¢çš„ $f$ çš„ç¬¬äºŒé¡¹ä¸ $d$ çš„ç¬¬äºŒé¡¹ç›¸åŒï¼Œå°±åƒä¸€ä¸ª $(t - 1) \times u$ çš„çŸ©é˜µåœ¨è·Ÿä¸€ä¸ª $u \times v$ çš„çŸ©é˜µåšä¹˜æ³•ï¼Œå¾—åˆ°äº†ä¸€ä¸ª $t \times u$ çš„çŸ©é˜µã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å°è¯•å°†ä¸Šè¿°å½¢å¼æ¨å¹¿æˆä¸€ä¸ªæ›´é€šç”¨çš„ç»“è®ºã€‚&lt;/p>
&lt;p>å®šä¹‰ä¸€ç§çŸ©é˜µè¿ç®— $\otimes$ã€‚è‹¥æœ‰ $A \otimes B = C$ï¼Œåˆ™ $A$ çš„åˆ—æ•°å’Œ $B$ çš„è¡Œæ•°ç›¸åŒï¼Œ$C$ çš„è¡Œæ•°ä¸ $A$ ç›¸åŒï¼Œåˆ—æ•°ä¸ $B$ ç›¸åŒï¼Œä¸”å¯¹çŸ©é˜µ $C$ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œéƒ½æœ‰ï¼š$C_{i, j} = \max\left\lbrace A_{i, k} + B_{k, j} \right\rbrace$ã€‚æ ¹æ®å–æœ€å¤§å€¼ $\max$ è¿ç®—çš„ç»“åˆå¾‹ï¼Œå¯ä»¥è¯æ˜ï¼Œè¯¥è¿ç®—åŒæ ·æ»¡è¶³ç»“åˆå¾‹ã€‚&lt;/p>
&lt;p>ç”±äºå›¾ä¸­ç‚¹çš„æ•°é‡æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ $d$ å¯ä»¥è§†ä¸ºä¸€ä¸ªè¡Œåˆ—æ•°ç›¸ç­‰çš„çŸ©é˜µï¼Œåˆç”±äº $\otimes$ è¿ç®—å…·æœ‰ç»“åˆå¾‹ï¼Œå› æ­¤ $d$ å¯ä»¥é€šè¿‡å¯¹æ•°å¤æ‚åº¦çš„ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€ï¼ˆä½†å…¶ä¸­çš„ã€Œä¹˜æ³•ã€å®é™…ä¸Šæ˜¯ $\otimes$ è¿ç®—ï¼‰è¿›è¡Œè¿­ä»£ã€‚åœ¨è¿™æ ·çš„è§‚ç‚¹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°† $f_t$ è§†ä¸ºä¸€ä¸ªè¡Œå‘é‡ï¼Œå…¶æ¯ä¸€ä¸ªå…ƒç´ ä¸º $f_{t, v}$ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªéå¸¸ç¥å¥‡ âœ¨ çš„è½¬ç§»æ–¹ç¨‹ï¼š&lt;/p>
&lt;p>$$
f_t = f_0 \otimes d^t
$$&lt;/p>
&lt;p>ä¸‹é¢ç”¨äººè¯æ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ–¹ç¨‹çš„æ„æ€ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æ ¹æ®æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„è¿ç®—æ‰€å…·æœ‰çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŒä¸€ç±» $d$ çš„ï¼Œä»åˆå§‹çŠ¶æ€ $t_0 = 0$ åˆ°ç‰¹å®šçŠ¶æ€ $t$ çš„è´¡çŒ®ç´¯ç§¯èµ·æ¥ï¼Œä½†è¯¥æ“ä½œæ˜¯é€šè¿‡åå¤è¿›è¡Œ $\otimes$ è¿ç®—ï¼Œç”¨ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€çš„å½¢å¼å°†è½¬ç§»æœ¬èº«ä¼˜åŒ–ä¸º $\mathcal{O}(\log t)$ å¤æ‚åº¦ï¼Œç”±æ­¤è®¡ç®—å‡º $d^t$ æ¥å®ç°çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†é€šè¿‡ä¸€æ¬¡ $\otimes$ è¿ç®—å°†è®¡ç®—å‡ºæ¥çš„è´¡çŒ®å åŠ åˆ°åˆå§‹çŠ¶æ€ $f_0$ ä¸Šï¼Œç”±æ­¤è·å¾— $f_t$ çš„çŠ¶æ€ã€‚&lt;/p>
&lt;p>ç”±äº $f$ æ˜¯è¡Œå‘é‡ï¼Œå…¶è¡Œæ•°å¯è§†ä¸º $1$ï¼Œåˆ—æ•°å¯è§†ä¸ºå…ƒç´ æ•° $n$ï¼›è€Œ $d$ ä¸º $n \times n$ çŸ©é˜µï¼Œæ‰€ä»¥ $f_0 \otimes d^t$ æ‰€å¾—åˆ°çš„ç»“æœçš„è¡Œæ•°ä¾ç„¶ä¸º $1$ï¼Œåˆ—æ•°ä¾ç„¶ä¸º $n$ï¼Œä¹Ÿå°±ä¾ç„¶ç¬¦åˆ $f$ çš„è¡Œå‘é‡çš„å½¢å¼ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ ¹æ® $c$ æ•°ç»„æ„å»º $d$ çŸ©é˜µï¼ˆæ²¡æœ‰è¾¹ç›¸è¿çš„åœ°æ–¹ï¼Œå€¼ä¸º $-\infty$ï¼‰ï¼Œé‚£ä¹ˆç°åœ¨çš„ä»»åŠ¡å°±æ˜¯ç¡®å®šåˆå§‹çŠ¶æ€ $f_0$ å®é™…ä¸Šåº”è¯¥æ˜¯ä»€ä¹ˆäº†ã€‚è€ƒè™‘ $f$ çš„å®šä¹‰ï¼š$f_{t, v}$ è¡¨ç¤ºç¬¬ $t$ å¤©èµ°åˆ°äº†åŸå¸‚ $v$ æ—¶æ‰€èƒ½æŒæœ‰çš„æœ€å¤§æ„‰æ‚¦å€¼ã€‚ç”±é¢˜ç›®å¯çŸ¥ï¼Œä¸»äººå…¬æœ€åˆï¼ˆç¬¬ $0$ å¤©ï¼‰åœ¨åŸå¸‚ $1$ï¼Œæ ¹æ®æ•°æ®èŒƒå›´ï¼Œç¬¬ $0$ å¤©ä¸ä¼šæœ‰ç¾é£ŸèŠ‚ï¼ˆ$1 \leqslant t_i \leqslant 10^9$ï¼‰ï¼Œæ‰€ä»¥ $f_0$ çš„å…ƒç´ ä¸­åªæœ‰ä¸€ä¸ªæœ‰å€¼ï¼Œå³ $f_{0, 1} = c_1$ï¼Œå…¶ä»–åœ°æ–¹çš„å€¼éƒ½æ˜¯ $-\infty$ã€‚&lt;/p>
&lt;h2 id="çŸ©é˜µä¼˜åŒ–çš„æ¨å¹¿">çŸ©é˜µä¼˜åŒ–çš„æ¨å¹¿
&lt;/h2>&lt;p>è¿˜è®°å¾—å—ï¼Ÿä¸Šä¸€å°èŠ‚é‡Œçš„æ¨å¯¼éƒ½æ˜¯åŸºäº $w = 1$ çš„å‰æçš„ã€‚è€Œé¢˜ç›®ä¸­ $w$ çš„å€¼å¯èƒ½åœ¨ $[1, 5]$ ä¹‹é—´å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ€è€ƒå¦‚ä½•å°†åŸæ¥çš„ç»“è®ºåº”ç”¨åˆ°é¢˜ç›®ä¸­æ¥ã€‚å½“ $w = 1$ æ—¶ï¼Œæˆ‘ä»¬å¯¹ $d$ é‡å¤è¿›è¡Œçš„ $\otimes$ è¿ç®—ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»¥ $w = 1$ ä¸ºå•ä½åœ¨å¯¹è´¡çŒ®è¿›è¡Œå åŠ ã€‚æˆ–è€…è¯´ï¼Œå¦‚æœ $w \in [1, 5]$ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†è¿™äº›è¾¹æƒæ‹†æˆ $1$ åˆ° $5$ æ¡ $w = 1$ çš„è¾¹ï¼Œåœ¨åŸæœ‰çš„è¿™æ¡è¾¹çš„èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´å†åŠ å…¥ $w - 1$ ä¸ªç‚¹æ¥æ‰¿æ¥è¿™äº›æ–°åŠ çš„è¾¹ï¼Œå†å°†å…¶è´¡çŒ®è¿›è¡Œå åŠ ã€‚è¯´ç™½äº†å°±æ˜¯ï¼Œå¦‚æœå°†æ­¤å‰æˆ‘ä»¬æ¨å¯¼æ—¶ä½¿ç”¨çš„ $d$ å†™æˆ $d^1$ï¼Œé‚£ä¹ˆç°åœ¨ä¸€æ¡è¾¹æƒä¸º $w$ çš„è¾¹çš„è´¡çŒ®å°±æ˜¯ $d^w$ï¼Œåªæ˜¯æˆ‘ä»¬å°†æŒ‡æ•° $w$ æºåˆ°äº†æ•´ä½“çš„æŒ‡æ•°é‡Œè¿›è¡Œè®¡ç®—ã€‚&lt;/p>
&lt;p>ä¸è¿‡è¿™æ ·æ‹†æœ‰ä¸ªå°é—®é¢˜ã€‚æç«¯æƒ…å†µä¸‹ï¼Œå¯¹äºæ‰€æœ‰çš„ $m_{\max} = 501$ æ¡è¾¹ï¼Œæ¯ä¸€æ¡è¾¹çš„è¾¹æƒéƒ½ä¸º $w_{\max} = 5$ï¼Œé‚£ä¹ˆå°±éœ€è¦æ–°å¢ $\left (w_{\max} - 1 \right ) m_{\max} = 2004$ ä¸ªç‚¹ã€‚åˆ«å¿˜äº†æˆ‘ä»¬æ‰€éœ€è¦ç”¨åˆ°çš„çŸ©é˜µå¿«é€Ÿå¹‚ä¸­ï¼Œå¯¹ä¸€ä¸ªå…·æœ‰ $n$ ç‚¹çš„å›¾çš„é‚»æ¥çŸ©é˜µæ‰§è¡ŒçŸ©é˜µä¹˜æ³•æœ¬èº«ä¹Ÿæ˜¯å…·æœ‰ $\mathcal{O}(n^3)$ çš„å¤æ‚åº¦çš„ï¼å‡å¦‚æˆ‘ä»¬çš„ç‚¹æ•°æ€»å…±ä¸º $\left[ n_{\max} + \left( w_{\max} - 1 \right) m \right] _ {\max} = 2054$ï¼Œé‚£ä¹ˆå…‰æ‰§è¡Œä¸€æ¬¡çŸ©é˜µä¹˜æ³•å°±å·²ç»è¦è¶…æ—¶äº†ã€‚æœ‰æ²¡æœ‰ä¸€ç§æ‹†åˆ†çš„æ–¹æ³•èƒ½å¤Ÿè¾ƒå°åœ°å½±å“å®é™…çš„ç‚¹æ•°å‘¢ï¼Ÿ&lt;/p>
&lt;p>æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ç§æ‹†æ³•ï¼šå°†æ¯ä¸€ä¸ªç‚¹æ‹†æˆ $w$ ä¸ªç‚¹ï¼Œè¿™äº›ç‚¹ä¹‹é—´éƒ½ç”¨ä¸€æ¡è¾¹æƒä¸º $0$ çš„è¾¹è¿æ¥ã€‚&lt;span class="text-highlight">
å¯¹äºæ¯ä¸€æ¡è¾¹ $(u, v, w)$ï¼Œè®© $u$ æ‹†å‡ºæ¥çš„ç¬¬ $w$ ä¸ªç‚¹ $u_w$ ä¸ $v$ æ‹†å‡ºæ¥çš„ç¬¬ä¸€ä¸ªç‚¹ $v_1$ ä¹‹é—´ç”¨ä¸€æ¡è¾¹æƒä¸º $w$ çš„è¾¹ç›¸è¿ã€‚
&lt;/span>
è¿™æ ·åšï¼Œé¦–å…ˆåªä¼šç”¨åˆ° $w_{\max}n = 5n$ ä¸ªç‚¹ï¼ˆç”±äºæ¯æ¡è¾¹çš„ $w \in [1, 5]$ï¼Œ$u$ æ‹†å‡ºæ¥æ¯ä¸ªç‚¹ä¸Šéƒ½å¯èƒ½æœ‰å‘å…¶ä»–ç‚¹çš„è¿è¾¹ï¼Œæ‰€ä»¥æ€»å…±çš„ç‚¹æ•°å…¶å®å°±æ˜¯é’‰æ­»äº†çš„ $5n$ï¼‰ï¼Œè‡³å°‘è®©çŸ©é˜µä¹˜æ³•çš„å¤æ‚åº¦é™åˆ°äº†ä¸€ä¸ªå¯ä»¥æ§åˆ¶çš„èŒƒå›´ã€‚è‡³äºè¿™æ ·åšä¸ºä»€ä¹ˆæ­£ç¡®ï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨äº†æ­¤å‰å°±å·²ç»æ˜ç¡®çš„ã€Œæ— è®ºæŒ‡æ•°æ˜¯å¤šå°‘æœ€åéƒ½ä¼šæ‰åˆ°ä¸€èµ·å»ã€çš„è§‚ç‚¹ï¼Œå¹¶ä¸”æ— è®ºæŒ‡æ•°æ˜¯å¤šå°‘æ‰€ç»è¿‡çš„è½¬ç§»éƒ½æ°å¥½æ˜¯ $w$ æ­¥ã€‚&lt;/p>
&lt;p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸå°†æ¨å¾—çš„ç»“è®ºåº”ç”¨åˆ°äº† $w \in [1, 5]$ çš„æƒ…å†µã€‚æ‘†åœ¨æˆ‘ä»¬é¢å‰çš„éš¾é¢˜è¶Šæ¥è¶Šå°‘äº†ï¼&lt;/p>
&lt;h2 id="é¢å¤–å› ç´ çš„è€ƒè™‘">é¢å¤–å› ç´ çš„è€ƒè™‘
&lt;/h2>&lt;p>åˆ«å¿˜äº†è¿˜æœ‰ã€Œç¾é£ŸèŠ‚ã€è¿™ä¸€è®¾å®šï¼å›æ”¶ä¼ç¬”å•¦ï¼æˆ‘ä»¬è¦æƒ³åŠæ³•å°†ç¾é£ŸèŠ‚çš„è´¡çŒ®åŠ å…¥æˆ‘ä»¬ç°æœ‰çš„ä½“ç³»ä¸­ï¼Œè¯¥å¦‚ä½•åšå‘¢ï¼Ÿé¦–å…ˆå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œç¾é£ŸèŠ‚æ˜¾ç„¶æ²¡æœ‰åŠæ³•ç›´æ¥åŠ å…¥æˆ‘ä»¬çš„çŸ©é˜µè½¬ç§»ï¼Œå› ä¸ºç¾é£ŸèŠ‚çš„æ—¶é—´åœ°ç‚¹å’Œè´¡çŒ®å¤§å°éƒ½æ˜¯ä¸ç¡®å®šçš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¾é£ŸèŠ‚çš„å…·ä½“ä¿¡æ¯ï¼Œåœ¨è½¬ç§»è¿‡ç¨‹ä¸­ä¿®æ”¹å¯¹åº”æ—¶é—´ã€åŸå¸‚çš„è´¡çŒ®å€¼ã€‚&lt;/p>
&lt;p>ç”±äºè½¬ç§»è¿‡ç¨‹æ˜¯æ ¹æ® $t$ ä»å°åˆ°å¤§è¿›è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ç¾é£ŸèŠ‚ $\left(t, x, y \right)$ æ ¹æ® $t$ è¿›è¡Œæ’åºï¼Œå¹¶åœ¨è½¬ç§»æ—¶ï¼Œæ¯æ¬¡æ‰§è¡Œã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€ç›´åˆ°ä¸‹ä¸€ä¸ªç¾é£ŸèŠ‚å‘ç”Ÿçš„æ—¶é—´ $t$ï¼Œå¹¶å°†è¿™ä¸ªç¾é£ŸèŠ‚ $\left(t, x, y \right)$ çš„è´¡çŒ® $y$ æ·»åŠ åˆ°ç¬¬ $t$ å¤©çš„åŸå¸‚ $x$ ä¸Šï¼Œç„¶åç»§ç»­é€šè¿‡ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€ä»å½“å‰æ—¶é—´ $t$ ä¸ºèµ·ç‚¹è¿›è¡Œè½¬ç§»ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åƒæ˜¯ä¹˜åæ¸¸è½®ï¼Œåœ¨æµ·ä¸Šèˆªè¡Œçš„è¿‡ç¨‹å°±æ˜¯æ‰§è¡ŒçŸ©é˜µå¿«é€Ÿå¹‚æ¥ä¼˜åŒ–è½¬ç§»æ—¶é—´å¤æ‚åº¦çš„è¿‡ç¨‹ï¼Œè€Œæ¯æ¬¡é å²¸ã€ä¸‹èˆ¹æ¸¸ç©åˆ™æ˜¯åœ¨å½“å‰ä½ç½®å åŠ ç¾é£ŸèŠ‚çš„è´¡çŒ®çš„ã€æ—¶é—´å¤æ‚åº¦æœ´ç´ çš„è¿‡ç¨‹ã€‚&lt;/p>
&lt;h2 id="æœ€åä¸€å…¬é‡Œ">æœ€åä¸€å…¬é‡Œ
&lt;/h2>&lt;p>ä¸è€ƒè™‘ç¾é£ŸèŠ‚çš„æƒ…å†µä¸‹ï¼Œæ‹†ç‚¹ä¹‹åï¼Œã€ŒçŸ©é˜µä¹˜æ³•ã€æ‰§è¡Œä¸€æ¬¡çš„å¤æ‚åº¦ä¸º $\mathcal{O}(N^3)$ï¼Œå…¶ä¸­ $N = 5n$ï¼Œæ‰€ä»¥ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€çš„å¤æ‚åº¦å°±ä¸º $\mathcal{O}(N^3 \log T)$ã€‚ä½†ç”±äºæˆ‘ä»¬åœ¨è€ƒè™‘ç¾é£ŸèŠ‚ä¹‹åï¼Œç”±äºå°†åŸæœ‰çš„ä¸€æ•´ä¸ªé•¿åº¦ä¸º $\log T$ çš„å¿«é€Ÿå¹‚æ®µåˆ†è§£æˆäº†æœ€å¤š $201$ ä¸ªå°æ®µï¼ˆ$k_{\max} = 200$ï¼‰ï¼Œæ‰€ä»¥å®é™…çš„å¤æ‚åº¦ä¸º $\mathcal{O}\left(N^3 \sum\log\left(t_i - t_{i - 1}\right)\right)$ã€‚ç”±äº $N_{\max} = 250$ï¼Œæœ‰ ${N ^ 3}_{\max} = 1.5625 \times 10^7$ï¼Œå†ä¹˜ä¸Šä¸€ä¸ª $200$ å¾ˆæ˜¾ç„¶ä¾ç„¶ä¼šè¶…æ—¶ã€‚&lt;/p>
&lt;p>æ€ä¹ˆåŠå‘¢ï¼ŸDP çš„è¿‡ç¨‹å·²ç»æƒ³ä¸å‡ºä»»ä½•å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬è€ƒè™‘å†æ¬¡ä¼˜åŒ–ã€ŒçŸ©é˜µå¿«é€Ÿå¹‚ã€ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ­¤å‰æˆ‘ä»¬è¯´ã€ŒçŸ©é˜µä¹˜æ³•ã€æ‰§è¡Œä¸€æ¬¡çš„å¤æ‚åº¦ä¸º $\mathcal{O}(N^3)$ï¼Œæ˜¯å› ä¸ºæ˜¯åœ¨å¯¹ä¸€ä¸ª $N \times N$ çš„é‚»æ¥çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼Œå…¶ç»“æœæœ€ç»ˆè½è„šåˆ°è½¬ç§»çŸ©é˜µ $f_t$ ä¸Šï¼Œè€Œ $f_t$ æ˜¯ä¸€ä¸ªè¡Œå‘é‡ã€‚å¦‚æœèƒ½å¤Ÿç›´æ¥å°†æ“ä½œåœ¨ $f_t$ ä¸Šé¢æ‰§è¡Œï¼Œä¸å€Ÿç”¨ä¸€æ•´ä¸ªé‚»æ¥çŸ©é˜µï¼Œæˆ‘ä»¬æˆ–è®¸å°±å¯ä»¥å°†åŸæœ¬ $\mathcal{O}(N^3)$ çš„å¤æ‚åº¦é™ä½åˆ° $\mathcal{O}(N^2)$ï¼Œä»è€Œé€šè¿‡æ­¤é¢˜ã€‚&lt;/p>
&lt;p>ç”±äº $\otimes$ è¿ç®—å…·æœ‰ç»“åˆå¾‹ï¼Œæ‰€ä»¥å¯¹åŸæœ¬çš„ DP è½¬ç§»å¼ $f_t = f_0 \otimes d^t$ï¼Œåœ¨è€ƒè™‘ç¾é£ŸèŠ‚åå³ $f_{t_i} = f_{t_{i - 1}} \otimes d^{t_i - t_{i - 1}}$ã€‚æˆ‘ä»¬å¯ä»¥å°†å¿«é€Ÿå¹‚ $d^{t_i - t_{i - 1}}$ ä¸­åˆ†è§£å‡ºæ¥çš„è‹¥å¹²ä¸ª $d^{2^k}$ ç›´æ¥ $\otimes$ ä¹˜åˆ° $f_{t_{i - 1}}$ ä¸Šé¢ï¼ç”±äº $f_t$ æ˜¯è¡Œå‘é‡ï¼Œç›¸å¯¹äºæ•´ä¸ªé‚»æ¥çŸ©é˜µæ¥è¯´å°‘äº†ä¸€ç»´ï¼Œå°±å¯ä»¥åƒä¸Šé¢æ‰€è¯´çš„å®ç° $\mathcal{O}(N^2)$ è½¬ç§»äº†ï¼ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…¶å®åªéœ€è¦åœ¨å¾—å‡ºæ•´ä¸ªé‚»æ¥çŸ©é˜µ $d$ åï¼Œç”¨ $\mathcal{O}(N^3 \log T)$ çš„å¤æ‚åº¦å°†æ‰€æœ‰æ»¡è¶³ $2 ^ k \leqslant T$ çš„ $d^{2^k}$ å…¨éƒ¨è®¡ç®—ä¸€éå°±å¥½äº†ã€‚è®¡ç®—å‡ºæ¥ä¹‹åï¼Œä¸¤æ¬¡ç¾é£ŸèŠ‚ä¹‹é—´å°±å¯ä»¥ $\mathcal{O}\left(N^2 \sum\log\left(t_i - t_{i - 1}\right)\right)$ å¤æ‚åº¦è½¬ç§»ï¼Œæ€»å…± $k$ æ¬¡ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦å°±ä¸ºï¼š&lt;/p>
&lt;p>$$
\mathcal{O} \left (k \log k + N^3 \log T + k \cdot N^2 \sum\log\left(t_i - t_{i - 1}\right) \right ).
$$&lt;/p>
&lt;h2 id="ä»£ç ">ä»£ç 
&lt;/h2>&lt;details>
&lt;summary>ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨ä»£ç &lt;/summary>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;tuple&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;algorithm&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="n">LL&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kt">long&lt;/span> &lt;span class="kt">long&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="n">TUP&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">tuple&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">MAX_N&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">55&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">MAX_LG_T&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">35&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">MAX_K&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">2e2&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">MAX_N_S&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">MAX_N&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="n">LL&lt;/span> &lt;span class="n">LL_MIN&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0xC0C0C0C0C0C0C0C0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">Matrix&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LL&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_N_S&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">MAX_N_S&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">fill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="n">LL&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">row&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Matrix&lt;/span> &lt;span class="k">operator&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="n">Matrix&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Matrix&lt;/span> &lt;span class="nf">C&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">B&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">col&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">LL_MIN&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">row&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">k&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">k&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">B&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">col&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">C&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">B&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">C&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Matrix&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Matrix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">_r&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">_c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="n">LL&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_r&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">col&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">fill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">K&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_N&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">logT&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TUP&lt;/span> &lt;span class="n">fest&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_K&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Matrix&lt;/span> &lt;span class="n">G&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_LG_T&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">prep&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">G&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">logT&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">power&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Matrix&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">A&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">b&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">logT&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">b&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">A&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pow2&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">A&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">ios&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">sync_with_stdio&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">false&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">tie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">nullptr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cin&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">m&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">T&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">K&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">logT&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">__lg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// è®¡ç®— log(T) çš„å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">G&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Matrix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">LL_MIN&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// åˆ›å»ºé‚»æ¥çŸ©é˜µå¹¶ç”¨è´Ÿæ— ç©·å¡«å……
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ–æ¯ä¸ªç‚¹æ‰€æ‹†æˆçš„äº”ä¸ªç‚¹ä¹‹é—´çš„è¿è¾¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">w&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">w&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">w&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">G&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">w&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">w&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cin&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">u&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">w&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cin&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">u&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">v&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">w&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">G&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">w&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">u&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">u&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="c1">// æŒ‰ç…§è¾¹çš„ä¿¡æ¯æŠŠè¾¹è¿åˆ°æ‹†å¼€çš„ç‚¹ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">K&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">auto&lt;/span>&lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fest&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cin&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">t&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">prep&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">// äºŒè¿›åˆ¶é¢„å¤„ç†é‚»æ¥çŸ©é˜µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fest&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fest&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">K&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å¯¹ç¾é£ŸèŠ‚è¿›è¡Œæ’åº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Matrix&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">LL_MIN&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// åˆ›å»º f è¡Œå‘é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// åˆå§‹åŒ–
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆ†æ®µè½¬ç§»
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">current_time&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="n">K&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">auto&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">city&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">joy&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fest&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">power&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">vec&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">time&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">current_time&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">city&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">joy&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current_time&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">power&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">vec&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">T&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">current_time&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¾“å‡ºç­”æ¡ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">LL&lt;/span> &lt;span class="n">ans&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">vec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="c1">// ç”±äºè½¬ç§»ä¸è€ƒè™‘ç¬¬ä¸€ä¸ªåŸå¸‚ï¼Œéœ€è¦é¢å¤–åŠ ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ans&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">ans&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">endl&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// è¾“å‡ºç­”æ¡ˆæˆ–è€…æŠ¥å‘Šæ— è§£
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;/details></description></item></channel></rss>