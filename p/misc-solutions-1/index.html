<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="æ¥è‡ª JOI ç³»åˆ—æ¯”èµ›ã€LibreOJ åŸåˆ›ä»¥åŠ Codeforces çš„å››é“é¢˜ï¼"><title>æ‚é¢˜é€‰è§£ï¼ˆä¸€ï¼‰</title>
<link rel=canonical href=https://eoin.blog/p/misc-solutions-1/><link rel=stylesheet href=/scss/style.min.5b67378878f34609120600e0f03f54ef00673042fa6572b2d4d38069dbfb89a6.css><meta property='og:title' content="æ‚é¢˜é€‰è§£ï¼ˆä¸€ï¼‰"><meta property='og:description' content="æ¥è‡ª JOI ç³»åˆ—æ¯”èµ›ã€LibreOJ åŸåˆ›ä»¥åŠ Codeforces çš„å››é“é¢˜ï¼"><meta property='og:url' content='https://eoin.blog/p/misc-solutions-1/'><meta property='og:site_name' content="Eoin Lee's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='å›¾è®º'><meta property='article:tag' content='æ•°æ®ç»“æ„'><meta property='article:published_time' content='2024-05-10T00:00:03+08:00'><meta property='article:modified_time' content='2024-05-10T00:00:03+08:00'><meta name=twitter:title content="æ‚é¢˜é€‰è§£ï¼ˆä¸€ï¼‰"><meta name=twitter:description content="æ¥è‡ª JOI ç³»åˆ—æ¯”èµ›ã€LibreOJ åŸåˆ›ä»¥åŠ Codeforces çš„å››é“é¢˜ï¼"><link rel="shortcut icon" href=/favicon.jpg><style>:root{--zh-font-family:"PingFang SC", "Source Han Sans SC VF",
      "Source Han Sans SC", "Noto Sans CJK SC", "Microsoft YaHei UI",
      "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif;--base-font-family:var(--sys-font-family), var(--zh-font-family),
      sans-serif, "Noto Color Emoji";--code-font-family:Menlo, Monaco, Consolas, "Courier New",
      var(--zh-font-family), monospace;--article-font-family:var(--base-font-family);font-optical-sizing:auto}</style><script>(function(){const t=document.createElement("link"),e=document.createElement("link"),n=document.createElement("link");t.rel="preconnect",t.href="https://fonts.googleapis.com",e.rel="preconnect",e.href="https://fonts.gstatic.com",e.crossOrigin="anonymous",n.rel="stylesheet",n.href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap",document.head.appendChild(t),document.head.appendChild(e),document.head.appendChild(n)})()</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu13c40bb6d89fba0f45d34b039ac03ece_1893705_300x0_resize_q75_box.jpeg width=300 height=301 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ‡¨ğŸ‡³</span></figure><div class=site-meta><h1 class=site-name><a href=/>Eoin Lee's Blog</a></h1><h2 class=site-description>Collection of my everyday random thoughts.</h2></div></header><ol class=menu-social><li><a href=https://github.com/eoinli target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/eoinlee target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://www.youtube.com/@eoinleeee target=_blank title=YouTube rel=me><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-youtube"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M2 8a4 4 0 014-4h12a4 4 0 014 4v8a4 4 0 01-4 4H6a4 4 0 01-4-4V8z"/><path d="M10 9l5 3-5 3z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/projects/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-bulb"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12h1m8-9v1m8 8h1M5.6 5.6l.7.7m12.1-.7-.7.7"/><path d="M9 16a5 5 0 116 0 3.5 3.5.0 00-1 3 2 2 0 01-4 0 3.5 3.5.0 00-1-3"/><path d="M9.7 17h4.6"/></svg>
<span>é¡¹ç›®</span></a></li><li><a href=/friends/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å‹é“¾</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://eoin.blog/ selected>ç®€ä½“ä¸­æ–‡</option><option value=https://eoin.blog/en/>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#foehn-phenomena>Foehn Phenomena</a></li><li><a href=#æš‘å‡æ—¶åœ¨åšä»€ä¹ˆæœ‰æ²¡æœ‰ç©ºå¯ä»¥æ¥å­¦ç‰©ç†å—>æš‘å‡æ—¶åœ¨åšä»€ä¹ˆï¼Ÿæœ‰æ²¡æœ‰ç©ºï¼Ÿå¯ä»¥æ¥å­¦ç‰©ç†å—ï¼Ÿ</a></li><li><a href=#water-bottle>Water Bottle</a></li><li><a href=#yet-another-array-counting-problem>Yet Another Array Counting Problem</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/editorial/ style=background-color:#7469b6;color:#fff>é¢˜è§£
</a><a href=/categories/notes/ style=background-color:#2a9d8f;color:#fff>ç¬”è®°</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/misc-solutions-1/>æ‚é¢˜é€‰è§£ï¼ˆä¸€ï¼‰</a></h2><h3 class=article-subtitle>æ¥è‡ª JOI ç³»åˆ—æ¯”èµ›ã€LibreOJ åŸåˆ›ä»¥åŠ Codeforces çš„å››é“é¢˜ï¼</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 10, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 12 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>æœ¬ç¯‡æ‚é¢˜é€‰è§£åŒ…å«å››é“é¢˜çš„æ–‡å­—è®²è§£ï¼Œé¢˜ç›®éš¾åº¦ä»ç»¿åˆ°ç´«ã€‚ä¸»è¦æ¶‰åŠäº†åˆ†æ²»æ€æƒ³ç»“åˆæ•°æ®ç»“æ„çš„åº”ç”¨ï¼Œä¹Ÿæ¶‰åŠåˆ°ä¸€äº›å›¾è®ºæ–¹é¢çš„é—®é¢˜ã€‚</p><h2 id=foehn-phenomena>Foehn Phenomena</h2><ul><li>å‡ºå¤„ï¼šJOI 2017 Final</li><li>å®˜æ–¹é¢˜é¢ï¼š<a class=link href=https://www2.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf target=_blank rel=noopener>æ—¥è¯­</a> & <a class=link href=https://www2.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf target=_blank rel=noopener>è‹±è¯­</a></li><li>è¯„æµ‹åœ°å€ï¼š<a class=link href=https://atcoder.jp/contests/joi2017ho/tasks/joi2017ho_a target=_blank rel=noopener>AtCoder</a> & <a class=link href=https://loj.ac/p/2332 target=_blank rel=noopener>LibreOJ #2332</a></li></ul><p>ç”±äºé¢˜ç›®çš„è®¾ç½®ä¸åºåˆ—ä¸­ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„å·®å€¼æœ‰å…³ï¼Œå¹¶ä¸”ä¹‹åç»™å‡ºçš„æ¯ä¸€æ¬¡æ“ä½œéƒ½éœ€è¦è¿›è¡Œä¸€æ¬¡åŒºé—´åŠ ï¼Œå°±å¾ˆå®¹æ˜“æƒ³åˆ°é€šè¿‡å·®åˆ†ç»´æŠ¤ã€‚è€ƒè™‘åˆ°æ¯æ¬¡ä¿®æ”¹éƒ½æ˜¯å¯¹åŒºé—´çš„æµ·æ‹”è¿›è¡Œæ•´ä½“å‡é«˜æˆ–é™ä½ï¼Œæ•…æ¯æ¬¡ä¿®æ”¹å¯¹å·®åˆ†æ•°ç»„çš„å½±å“åªä¼šä½“ç°åœ¨å·¦å³ä¸¤ä¸ªç«¯ç‚¹ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡ä¿®æ”¹æŸä¸ªåŒºé—´çš„æµ·æ‹”æ—¶ï¼Œç”±äºåŒºé—´å†…éƒ¨çš„ç›¸å¯¹åœ°å½¢ä¸å˜ï¼Œæ‰€ä»¥åŒºé—´å†…éƒ¨å¯¹æµ·é£æ¸©åº¦äº§ç”Ÿå½±å“çš„å¤§å°ä¹Ÿæ˜¯ä¸å˜çš„ï¼Œå› è€Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®ä¸¤ä¸ªç«¯ç‚¹å¤„çš„å·®å€¼å¯¹ç­”æ¡ˆè¿›è¡Œä¿®æ”¹å³å¯ã€‚</p><p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬å…ˆç¡®å®šåˆå§‹æƒ…å†µä¸‹å„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„å·®å€¼ï¼Œå¹¶ä¸”ä¾æ­¤ç»´æŠ¤æµ·é£åˆ°è¾¾ $N$ æ—¶æœ€ç»ˆçš„æ¸©åº¦ï¼Œç„¶åå†æ ¹æ®æ¯æ¬¡ä¿®æ”¹çš„å·¦å³ç«¯ç‚¹è¿›è¡Œæ“ä½œã€‚å¯¹äºä¸¤ä¸ªç«¯ç‚¹ï¼Œæˆ‘ä»¬å…ˆå‡å»æ ¹æ®æ­¤å‰çš„å·®å€¼ç¡®å®šçš„é£çš„æ¸©åº¦ï¼Œç„¶åå°†ä¿®æ”¹å€¼æ›´æ–°åˆ°è¯¥ä½ç½®å¯¹åº”çš„å·®åˆ†æ•°ç»„ä¸Šï¼Œæœ€åæ ¹æ®æ–°çš„å·®å€¼é‡æ–°è®¡ç®—é£çš„æ¸©åº¦ã€‚</p><p>åœ¨ä»£ç å®ç°ä¸Šæœ‰ä¸¤ä¸ªå°ç»†èŠ‚ï¼š</p><ul><li>å¦‚æœæµ·æ‹”ä»ä½åˆ°é«˜ï¼Œé‚£ä¹ˆæ¸©åº¦ä¸‹é™ï¼Œæ­¤æ—¶çš„å·®å€¼ä¸ºæ­£æ•°ï¼Œä½†å¯¹å·®åˆ†æ•°ç»„çš„å¢é‡åº”è¯¥æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œä¹Ÿå°±æ˜¯å·®å€¼ä¸ $S$ çš„ç§¯çš„ç›¸åæ•°ï¼›å¦‚æœæµ·æ‹”ä»é«˜åˆ°ä½ï¼Œé‚£ä¹ˆæ¸©åº¦ä¸Šå‡ï¼Œæ­¤æ—¶çš„å·®å€¼ä¸ºè´Ÿæ•°ï¼Œä½†å¯¹å·®åˆ†æ•°ç»„çš„å¢é‡åº”è¯¥æ˜¯ä¸€ä¸ªæ­£æ•°ï¼Œä¹Ÿå°±æ˜¯å·®å€¼ä¸ $T$ çš„ç§¯çš„ç›¸åæ•°ï¼›</li><li>å¦‚æœä¿®æ”¹çš„å³ç«¯ç‚¹æ˜¯ $N$ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹å¤„çš„å·®åˆ†ä»¥åŠç­”æ¡ˆå°±ä¸éœ€è¦æ›´æ–°äº†ï¼Œå› ä¸ºæ­¤æ—¶å³ç«¯ç‚¹çš„ä¿®æ”¹å½±å“ä¸åˆ°ä»»ä½•å·®å€¼ã€‚</li></ul><details><summary>ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨ä»£ç </summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define endl &#39;\n&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>i64</span> <span class=o>=</span> <span class=kt>long</span> <span class=kt>long</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>MAX_N</span> <span class=o>=</span> <span class=mf>2e5</span> <span class=o>+</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>N</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>S</span><span class=p>,</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>i64</span> <span class=n>delta</span><span class=p>[</span><span class=n>MAX_N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>i64</span> <span class=nf>alter</span><span class=p>(</span><span class=n>i64</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>delta</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>delta</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>S</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=n>delta</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>ios</span><span class=o>::</span><span class=n>sync_with_stdio</span><span class=p>(</span><span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span><span class=p>.</span><span class=n>tie</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>last</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>N</span> <span class=o>&gt;&gt;</span> <span class=n>Q</span> <span class=o>&gt;&gt;</span> <span class=n>S</span> <span class=o>&gt;&gt;</span> <span class=n>T</span> <span class=o>&gt;&gt;</span> <span class=n>last</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>curr</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>curr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>delta</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>curr</span> <span class=o>-</span> <span class=n>last</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>+=</span> <span class=n>alter</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>last</span> <span class=o>=</span> <span class=n>curr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>Q</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>L</span><span class=p>,</span> <span class=n>R</span><span class=p>,</span> <span class=n>X</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>L</span> <span class=o>&gt;&gt;</span> <span class=n>R</span> <span class=o>&gt;&gt;</span> <span class=n>X</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>-=</span> <span class=n>alter</span><span class=p>(</span><span class=n>L</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>delta</span><span class=p>[</span><span class=n>L</span><span class=p>]</span> <span class=o>+=</span> <span class=n>X</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>+=</span> <span class=n>alter</span><span class=p>(</span><span class=n>L</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>R</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>ans</span> <span class=o>-=</span> <span class=n>alter</span><span class=p>(</span><span class=n>R</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>delta</span><span class=p>[</span><span class=n>R</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>X</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>ans</span> <span class=o>+=</span> <span class=n>alter</span><span class=p>(</span><span class=n>R</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>ans</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>),</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h2 id=æš‘å‡æ—¶åœ¨åšä»€ä¹ˆæœ‰æ²¡æœ‰ç©ºå¯ä»¥æ¥å­¦ç‰©ç†å—>æš‘å‡æ—¶åœ¨åšä»€ä¹ˆï¼Ÿæœ‰æ²¡æœ‰ç©ºï¼Ÿå¯ä»¥æ¥å­¦ç‰©ç†å—ï¼Ÿ</h2><ul><li>å‡ºå¤„ï¼šLibreOJ</li><li>å®˜æ–¹é¢˜é¢åŠè¯„æµ‹åœ°å€ï¼š<a class=link href=https://loj.ac/p/6490 target=_blank rel=noopener>LibreOJ #6490</a></li><li>å‚è€ƒé¢˜è§£ï¼š<a class=link href=https://www.cnblogs.com/663B/p/16653601.html target=_blank rel=noopener>by ImALAS</a></li></ul><p>è¿™é“é¢˜çš„æœ´ç´ åšæ³•å…¶å®éå¸¸å¥½æƒ³ã€‚å¯¹äºæ¯ä¸€ä¸ª $a_i$ï¼Œæš´åŠ›æšä¸¾åŒºé—´é•¿åº¦ï¼Œç„¶åæšä¸¾åŒºé—´ç«¯ç‚¹ï¼Œæ±‚åŒºé—´å’Œï¼Œå–æœ€å¤§å€¼å³å¯ã€‚å¦‚æœåŠ ä¸Šä¸€ä¸ªå‰ç¼€å’Œä¼˜åŒ–ï¼Œé‚£ä¹ˆæœ´ç´ åšæ³•çš„å¤æ‚åº¦å°†è¾¾åˆ° $\mathcal{O} \left( n ^ 3 \right)$ã€‚</p><p>è€ƒè™‘å¦‚ä½•ä¼˜åŒ–ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€æ®µå­åŒºé—´ $\left[ L, R \right]$ï¼Œå®ƒçš„åŒºé—´å’Œå¯ä»¥é€šè¿‡å‰ç¼€å’Œå¾—åˆ°ï¼Œå³ $\sum _ {i = L} ^ {R} = \text{pre} _ R - \text{pre} _ {L - 1}$ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œå½“ $L, R$ å¹¶éç¡®å®šå€¼ï¼Œè€Œæ˜¯å„è‡ªåœ¨ä¸€ä¸ªç¡®å®šçš„å–å€¼èŒƒå›´å†…æµ®åŠ¨çš„æ—¶å€™ï¼Œæƒ³è¦æ‰¾åˆ°æœ€å¤§çš„å­åŒºé—´å’Œï¼Œå°±éœ€è¦æ‰¾åˆ°æœ€å°çš„ $\text{pre} _ {L - 1}$ ä»¥åŠæœ€å¤§çš„ $\text{pre} _ R$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°æ®ç»“æ„ç»´æŠ¤åŒºé—´æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œè€Œæ‰€éœ€è¦ç»´æŠ¤çš„åºåˆ—ä¾¿æ˜¯å‰ç¼€å’Œæ•°ç»„ã€‚æœ¬é¢˜ç”±äºæ—¶é™åªæœ‰ 400 æ¯«ç§’ã€æ²¡æœ‰å¯¹æ•°ç»„å…ƒç´ çš„ä¿®æ”¹å¹¶ä¸”åŒ…å«å¾ˆå¤šçš„æŸ¥è¯¢æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨ ST è¡¨æ¥ç»´æŠ¤ã€‚</p><p>ä¸è¿‡ï¼Œè¿™åªæ˜¯æŠŠå¯¹å•ä¸ª $a_i$ æ±‚ç­”æ¡ˆçš„é—®é¢˜è§£å†³äº†ï¼Œå¤æ‚åº¦è¿˜ä¸è¶³ä»¥æ‹¿æ»¡åˆ†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³æƒ³å¦‚ä½•ä¸€æ¬¡æ€§æ±‚å‡ºå¯¹äºæ‰€æœ‰å…ƒç´ çš„ç­”æ¡ˆã€‚è€ƒè™‘åˆ†æ²»ã€‚å¯¹äºæ¯ä¸€å±‚çš„é—®é¢˜è§„æ¨¡ï¼Œæˆ‘ä»¬å…ˆé€’å½’æ±‚å‡ºåªè€ƒè™‘å·¦åŠè¾¹æ—¶ï¼Œå·¦åŠè¾¹å…ƒç´ çš„æœ€ä¼˜ç­”æ¡ˆï¼Œä»¥åŠåªè€ƒè™‘å³åŠè¾¹æ—¶å³åŠè¾¹å…ƒç´ çš„æœ€ä¼˜ç­”æ¡ˆï¼Œç„¶åè€ƒè™‘å·¦å³ä¸¤è¾¹åˆå¹¶æ—¶å¯¹è§„æ¨¡å†…çš„æ‰€æœ‰å…ƒç´ çš„ç­”æ¡ˆé€ æˆçš„å½±å“ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨åˆå¹¶è€ƒè™‘å·¦å³ä¸¤è¾¹çš„å½±å“æ—¶ï¼Œä»¥å·¦åŠè¾¹ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆé¡ºåºéå†ä¸€éå·¦åŠè¾¹ $\left[ l, \text{mid} \right]$ çš„æ‰€æœ‰ä¸‹æ ‡ $i$ï¼Œç”¨ä¸€ä¸ª $p$ å˜é‡å­˜å‚¨æœ€ä¼˜ç­”æ¡ˆï¼Œæ¯æ¬¡æŸ¥è¯¢ç”¨ ST è¡¨æŸ¥è¯¢</p><p>$$
\left( \max\left\lbrace i + l - 1, \text{mid} + 1\right\rbrace , \min\left\lbrace i + r - 1, R\right\rbrace \right)
$$</p><p>åŒºé—´å†…çš„æœ€å¤§å‰ç¼€å’Œ $\text{pre} _ {\max}$ï¼ˆå…¶ä¸­ $l, r$ ä¸ºåŒºé—´é•¿åº¦çš„å–å€¼èŒƒå›´ï¼Œ$R$ ä¸ºé—®é¢˜è§„æ¨¡çš„ä¸Šç•Œï¼Œ$\text{mid}$ ä¸ºé—®é¢˜è§„æ¨¡çš„ä¸­ç‚¹ï¼‰ï¼Œç„¶åæ›´æ–° $p = \max\left\lbrace p, \text{pre}_{\max}\right\rbrace$ï¼Œ$f_i = \max\left\lbrace f_i, p\right\rbrace$ã€‚ä»¥ä¸Šæ˜¯åˆå¹¶æ—¶è€ƒè™‘å·¦åŠè¾¹çš„è¿‡ç¨‹ã€‚å¯¹äºå³åŠè¾¹ï¼Œéœ€è¦å€’åºéå†å¹¶ä½¿ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œç»´æŠ¤ï¼Œå–å¾—æœ€ä¼˜ç­”æ¡ˆã€‚</p><p>è¿˜æ˜¯ä»¥å·¦åŠè¾¹ä¸ºä¾‹ï¼Œè¿™æ ·åšçš„æ­£ç¡®æ€§åœ¨äºï¼š</p><ul><li>$p$ çš„èŒƒå›´ä¸€å®šä¼šè¦†ç›–å½“å‰éå†åˆ°çš„ä½ç½®ï¼Œå› ä¸ºæŸ¥è¯¢åŒºé—´çš„èµ·ç‚¹åœ¨å³åŠè¾¹ï¼Œæ‰€ä»¥æ— è®ºå¦‚ä½•æŸ¥è¯¢ï¼Œæœ€ç»ˆç»“æœä¸€å®šè¦†ç›–äº†å½“å‰ä½ç½®ç›´åˆ°å·¦åŠè¾¹çš„å³ç«¯ç‚¹åœ¨å†…çš„æ‰€æœ‰ä¸‹æ ‡ã€‚</li><li>å¦‚æœå·¦è¾¹çš„æŸä¸ªå…ƒç´ åœ¨è§„æ¨¡æ‰©å±•åˆ°å³è¾¹ç•Œåç­”æ¡ˆå¹¶ä¸ä¼˜äºæ­¤å‰åœ¨åˆ†æ²»å·¦åŠè¾¹è¿‡ç¨‹ä¸­ç¡®å®šçš„ç­”æ¡ˆï¼Œé‚£ä¹ˆ $f_i$ ä¸ä¼šè¢«æ›´æ–°ï¼›å¦‚æœæ‰©å±•ä¹‹åç­”æ¡ˆæ›´ä¼˜ï¼Œé‚£ä¹ˆ $f_i$ ä¼šè¢«æ›´æ–°ä¸ºæ›´ä¼˜çš„ç­”æ¡ˆã€‚</li></ul><p>ä»£ç å®ç°ä¸Šï¼Œéœ€è¦å…³æ³¨çš„åœ°æ–¹æœ‰ï¼š</p><ul><li>è®°å¾—å¼€ <code>long long</code>ï¼›</li><li>æ ¹æ®ä»¥ä¸Šæ–¹æ³•ä½¿ç”¨ ST è¡¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œä»¥å·¦åŠè¾¹ä¸ºä¾‹ï¼Œå½“å·¦è¾¹ç•Œå– $\text{mid} + 1$ ä¸”å³è¾¹ç•Œå– $i + r - 1$ çš„æ—¶å€™ï¼Œå¯èƒ½å‡ºç°å·¦è¾¹ç•Œå¤§äºå³è¾¹ç•Œçš„æƒ…å†µã€‚è¿™ç§æƒ…å†µè¡¨ç¤ºåŒºé—´é•¿åº¦å–ä¸åˆ°å³åŠè¾¹é‡Œï¼Œæ•…è¿”å›æå€¼æ¥é¿å…ç»Ÿè®¡è¿™ç§æƒ…å†µã€‚</li></ul><details><summary>ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨ä»£ç </summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;climits&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;cstring&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define endl &#39;\n&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>i64</span> <span class=o>=</span> <span class=kt>long</span> <span class=kt>long</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=mf>1e5</span> <span class=o>+</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>M</span> <span class=o>=</span> <span class=mi>20</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>SparseTable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=n>mx</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=n>M</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=n>mn</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=n>M</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>log2</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>exp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exp</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>exp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=n>i64</span><span class=o>*</span> <span class=n>v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>x</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>mx</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>mn</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>x</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&lt;=</span> <span class=n>x</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>mx</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>mx</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>mx</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                <span class=n>mn</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>mn</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>mn</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=nf>query_max</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>)</span> <span class=k>return</span> <span class=n>INT_MIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>log2</span><span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>max</span><span class=p>(</span><span class=n>mx</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>t</span><span class=p>],</span> <span class=n>mx</span><span class=p>[</span><span class=n>r</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>t</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=nf>query_min</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>)</span> <span class=k>return</span> <span class=n>INT_MAX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>log2</span><span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>min</span><span class=p>(</span><span class=n>mn</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>t</span><span class=p>],</span> <span class=n>mn</span><span class=p>[</span><span class=n>r</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>t</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>L</span><span class=p>,</span> <span class=n>R</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>a</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>i64</span> <span class=n>ans</span><span class=p>[</span><span class=n>N</span><span class=p>],</span> <span class=n>p</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>SparseTable</span> <span class=n>ST</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>solve</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;</span> <span class=n>L</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>l</span> <span class=o>==</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>L</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>ans</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>ans</span><span class=p>[</span><span class=n>l</span><span class=p>],</span> <span class=p>(</span><span class=n>i64</span><span class=p>)</span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>mid</span><span class=p>),</span> <span class=n>solve</span><span class=p>(</span><span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>i64</span> <span class=n>pre</span> <span class=o>=</span> <span class=n>LLONG_MIN</span><span class=p>,</span> <span class=n>suf</span> <span class=o>=</span> <span class=n>LLONG_MIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=n>L</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=n>R</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>pre</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>pre</span><span class=p>,</span> <span class=n>ST</span><span class=p>.</span><span class=n>query_max</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>pre</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>R</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>l</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>L</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>mid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>suf</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>suf</span><span class=p>,</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>ST</span><span class=p>.</span><span class=n>query_min</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>y</span> <span class=o>-</span> <span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>suf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ios</span><span class=o>::</span><span class=n>sync_with_stdio</span><span class=p>(</span><span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span><span class=p>.</span><span class=n>tie</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>L</span> <span class=o>&gt;&gt;</span> <span class=n>R</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>LLONG_MIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ST</span><span class=p>.</span><span class=n>init</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39; &#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h2 id=water-bottle>Water Bottle</h2><ul><li>å‡ºå¤„ï¼šJOISC 2014 Day 2</li><li>å®˜æ–¹é¢˜é¢ï¼š<a class=link href=https://www.ioi-jp.org/camp/2014/2014-sp-tasks/2014-sp-d2.pdf target=_blank rel=noopener>æ—¥è¯­</a></li><li>è¯„æµ‹åœ°å€ï¼š<a class=link href=https://atcoder.jp/contests/joisc2014/tasks/joisc2014_e target=_blank rel=noopener>AtCoder</a> & <a class=link href=https://loj.ac/p/2876 target=_blank rel=noopener>LibreOJ #2876</a></li><li>å‚è€ƒé¢˜è§£ï¼š<a class=link href=https://www2.ioi-jp.org/camp/2014/2014-sp-tasks/2014-sp-d2-bottle-review.pdf target=_blank rel=noopener>å…¬å¼è§£è¯´</a></li></ul><p>çœ‹åˆ°é¢˜ä¹‹åï¼Œå¾ˆå®¹æ˜“å‘ç°ä¸€ä¸ªè·å–ç­”æ¡ˆçš„æ–¹æ³•ã€‚æˆ‘ä»¬å‡è®¾æ±‚çš„æ˜¯ä»å»ºç­‘ç‰© $A$ åˆ°å»ºç­‘ç‰© $B$ çš„è·¯ä¸Šæ°´ç“¶è‡³å°‘éœ€è¦çš„å®¹é‡ã€‚é‚£ä¹ˆé¦–å…ˆï¼Œæœ€åŸºç¡€åœ°ï¼Œæ°´ç“¶æœ€å¤§éœ€è¦çš„å®¹é‡ä¾¿æ˜¯ä» $A$ ç›´æ¥èµ°åˆ° $B$ é€”ä¸­å®Œå…¨ä¸æ‰“æ°´çš„æƒ…å†µä¸‹ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯é•¿åº¦ $-1$ã€‚é‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ç§æ–¹å¼ï¼Œä½¿å¾—å…ˆä» $A$ åˆ°æŸå…¶ä»–å»ºç­‘ç‰© $C$ æ‰“æ°´ï¼Œå†ä» $C$ åˆ° $B$ çš„è¿‡ç¨‹ä»æ‰€éœ€æ°´ç“¶çš„æœ€å¤§å®¹é‡æ¯”ç›´æ¥èµ°æ‰€éœ€è¦çš„æœ€å¤§å®¹é‡è¦å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºè¿™ç§æ–¹å¼æ›´ä¼˜ã€‚åŒç†ï¼Œåœ¨ä¼˜åŒ–ä¹‹åçš„è·¯çº¿ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­ä¼˜åŒ–ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¼˜è§£ã€‚</p><p>å‰æ–‡ä¸­æˆ‘ä»¬å·²ç»æåˆ°ï¼šä»ä¸€ä¸ªå»ºç­‘ç‰©èµ°åˆ°å¦ä¸€ä¸ªå»ºç­‘ç‰©ä¸Šï¼Œå¦‚æœä¸ç»è¿‡å…¶ä»–å»ºç­‘ç‰©æ‰“æ°´ï¼Œé‚£ä¹ˆé€”ä¸­éœ€è¦æ¶ˆè€—çš„æ°´é‡å°±æ˜¯ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯é•¿åº¦ $-1$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ä¼˜è§£çš„è·¯å¾„ä¸€å®šæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæœ€çŸ­è·¯çš„æ‹¼æ¥ï¼Œå¹¶ä¸”åœ¨è¿™äº›æœ€çŸ­è·¯èƒ½å¤Ÿè¿é€šèµ·ç‚¹å’Œç»ˆç‚¹çš„å‰æä¸‹ï¼Œè¿˜è¦å°½å¯èƒ½è®©è¿™äº›æœ€çŸ­è·¯ä¸­çš„æœ€å¤§å€¼å°½å¯èƒ½å°ã€‚è¿™æ ·è¯´å®¹æ˜“è®©äººæƒ³åˆ°æ±‚æœ€å°ç”Ÿæˆæ ‘ã€‚å®é™…ä¸Šä¸æœ€å°ç”Ÿæˆæ ‘è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå› ä¸ºä¸ç”¨è¿é€šæ‰€æœ‰çš„å»ºç­‘ç‰©ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥åœ¨è¿™é“é¢˜ä¸­åº”ç”¨ Kruskal çš„æ€æƒ³ã€‚åŒæ—¶ï¼Œç”±äºç”¨ LCA åœ¨æ ‘ä¸Šæ±‚æœ€å¤§è¾¹æƒçš„å¤æ‚åº¦ $\mathcal{O} \left(\log n\right)$ è¿œä½äºåœ¨ä¸€èˆ¬å›¾ä¸Šç”¨ Dijkstra æ±‚æœ€çŸ­è·¯å’Œæœ€å¤§è¾¹æƒçš„å¤æ‚åº¦ $\mathcal{O} \left(n \log n\right)$ï¼Œæ•…å¦‚æœèƒ½æŠŠè¿™å¼ å›¾åŒ–æˆä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆæƒ³å¿…æ›´æœ‰åŠ©äºæˆ‘ä»¬è§£å†³è¿™é“é¢˜ã€‚</p><p>å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°æ‰€æœ‰å»ºç­‘ç‰©ä¸¤ä¸¤ä¹‹é—´çš„æœ€çŸ­è·ç¦»ï¼Ÿåœ¨æœ¬é¢˜ä¸­ï¼Œæ•´ä½“å¤æ‚åº¦è¾ƒå°ä¸”æ¯”è¾ƒç®€å•çš„æ–¹æ³•ä¹‹ä¸€æ˜¯å¤šæº BFSã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ç»´æŠ¤æ•´ä¸ªæ–¹æ ¼åœ°å›¾ä¸­æ¯ä¸€ä¸ªæ ¼å­è·ç¦»æœ€è¿‘çš„å»ºç­‘ç‰©çš„ç¼–å·ä»¥åŠäºŒè€…ä¹‹é—´çš„è·ç¦»ã€‚æœ€åˆå°†æ‰€æœ‰å»ºç­‘ç‰©ä¸€æ¬¡æ€§å…¨éƒ¨å‹å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶åä»¥è¿™è‹¥å¹²ä¸ªå»ºç­‘ç‰©ä¸ºæºç‚¹ä¸€å±‚å±‚åœ°å‘å¤–æ‰©æ•£ã€‚åœ¨ä»æŸä¸ªæºç‚¹ $u$ å¼€å§‹çš„æœç´¢ä¸­ï¼Œå¦‚æœå½“å‰æœç´¢åˆ°çš„æ ¼å­è¿˜æ²¡æœ‰æ ‡è®°ï¼Œè¯´æ˜è·ç¦»è¯¥æ ¼å­æœ€è¿‘çš„å»ºç­‘ç‰©å°±æ˜¯ $u$ï¼›å¦‚æœå·²ç»å­˜åœ¨äº†æŸä¸ªå…¶ä»–æºç‚¹ $v$ çš„æ ‡è®°ï¼Œè¯´æ˜å·²ç»åˆ°è¾¾äº†å½“å‰æºç‚¹ç®¡è¾–èŒƒå›´çš„è¾¹ç•Œã€‚ç”±äº BFS çš„æ€§è´¨ï¼Œåœ¨å½“å‰çŠ¶æ€ã€å½“å‰æ ¼å­ä¸‹ï¼Œå½“å‰æ ¼å­è·ç¦»è‡ªå·±çš„æºç‚¹ $u$ çš„è·ç¦»æœ€çŸ­ï¼Œè·ç¦»å½“å‰æ ¼å­çš„æ ‡è®°æ‰€å±çš„æºç‚¹ $v$ çš„è·ç¦»ä¹Ÿæœ€çŸ­ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæœ€çŸ­è·ç¦»çš„å’Œä¾¿æ˜¯ä» $u$ åˆ° $v$ çš„æœ€çŸ­è·ç¦»ã€‚</p><p>æˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰å»ºç­‘ç‰©ä¸¤ä¸¤ä¹‹é—´çš„æœ€çŸ­è·ç¦»åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å€ŸåŠ© Kruskal ç®—æ³•æ€æƒ³çš„æ—¶å€™äº†ã€‚æˆ‘ä»¬æ ¹æ®å»ºç­‘ç‰©ä¹‹é—´æœ€çŸ­è·ç¦»çš„é•¿åº¦ï¼Œä»å°åˆ°å¤§æšä¸¾æ‰€æœ‰çš„æœ€çŸ­è·ç¦»ï¼Œå¹¶ä»¥æœ€çŸ­è·ç¦»é•¿åº¦ä¸ºæƒå€¼ï¼Œåœ¨è¯¥æœ€çŸ­è·ç¦»æ²Ÿé€šçš„ä¸¤ä¸ªå»ºç­‘ç‰©ä¹‹é—´è¿ä¸€æ¡è¾¹ã€‚åŒä¸€ä¸ªè¿é€šå—ä¸­çš„ä¸¤ä¸ªå»ºç­‘ç‰©ä¸é‡å¤è¿è¾¹ã€‚è¿™æ ·ï¼Œå½“éå†å®Œæ‰€æœ‰è¾¹ä¹‹åï¼Œç±»ä¼¼ Kruskal æ„é€ æœ€å°ç”Ÿæˆæ ‘çš„åŸç†ï¼Œæˆ‘ä»¬å°±å»ºç«‹äº†ä¸€ç‰‡æ£®æ—ã€‚è¿™ç‰‡æ£®æ—ä¸­çš„æ¯ä¸€æ£µæ ‘ä»£è¡¨çš„è¿é€šå—åŒ…å«æ‰€æœ‰å¯è¿é€šçš„å»ºç­‘ç‰©ï¼Œå¹¶ä¸”æ ‘ä¸Šçš„æ‰€æœ‰è¾¹ä¸­é•¿åº¦çš„æœ€å¤§å€¼æœ€å°ã€‚æ ‘ä¸Šæ±‚æœ€çŸ­è·¯é—®é¢˜å¤æ‚åº¦å°±å°å¾ˆå¤šäº†ï¼Œå¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œç›´æ¥åœ¨è¿™æ£µæ ‘ä¸Šè·‘ LCA æ±‚è·¯å¾„ä¸Šçš„æœ€å¤§è¾¹æƒå³å¯ã€‚</p><p>ä»£ç å®ç°æ–¹é¢ï¼Œå€¼å¾—ä¸€æçš„æ˜¯æˆ‘ä»¬å¯¹å¤šæº BFS çš„ç»“æœè½¬ç§»åˆ° LCA è¿‡ç¨‹ä¸­çš„å¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å¼€ $N^2 \leqslant 4\times 10^6$ ä¸ª <code>vector</code>ï¼ˆåœ¨ç©ºé—´è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼‰å½“ä½œæ¡¶ï¼Œå½“å‡ºç°æœç´¢åˆ°å…¶ä»–æºç‚¹ç®¡è¾–çš„æ ¼å­æ—¶ï¼Œæˆ‘ä»¬å°†è‡ªå·±çš„æºç‚¹å’Œå¯¹æ–¹çš„æºç‚¹éƒ½å­˜å…¥å¯¹åº”çš„ <code>vector</code> ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸‹æ ‡ä¸ºå½“å‰æ ¼å­åˆ°è‡ªå·±æºç‚¹å’Œåˆ°å¯¹æ–¹æºç‚¹çš„ä¸¤ä¸ªæœ€çŸ­è·ç¦»ä¹‹å’Œçš„ <code>vector</code> å¤„ï¼Œæ–¹ä¾¿æŒ‰ç…§è¾¹æƒä»å°åˆ°å¤§æšä¸¾ã€‚</p><details><summary>ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨ä»£ç </summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;queue&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;vector&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;numeric&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;algorithm&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define endl &#39;\n&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>PII</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>MAX_N</span> <span class=o>=</span> <span class=mf>2e3</span> <span class=o>+</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>MAX_P</span> <span class=o>=</span> <span class=mf>2e5</span> <span class=o>+</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>dx</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>dy</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>N</span><span class=p>,</span> <span class=n>M</span><span class=p>,</span> <span class=n>P</span><span class=p>,</span> <span class=n>Q</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span> <span class=n>map</span><span class=p>[</span><span class=n>MAX_N</span><span class=p>][</span><span class=n>MAX_N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>queue</span><span class=o>&lt;</span><span class=n>PII</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>gov</span><span class=p>[</span><span class=n>MAX_N</span><span class=p>][</span><span class=n>MAX_N</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>dist</span><span class=p>[</span><span class=n>MAX_N</span><span class=p>][</span><span class=n>MAX_N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>PII</span><span class=o>&gt;</span> <span class=n>graph</span><span class=p>[</span><span class=n>MAX_P</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>PII</span><span class=o>&gt;</span> <span class=n>graph2</span><span class=p>[</span><span class=n>MAX_N</span> <span class=o>*</span> <span class=n>MAX_N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>UnionFind</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>fa</span><span class=p>[</span><span class=n>MAX_P</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span> <span class=n>std</span><span class=o>::</span><span class=n>iota</span><span class=p>(</span><span class=n>fa</span><span class=p>,</span> <span class=n>fa</span> <span class=o>+</span> <span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>find</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>==</span> <span class=n>x</span><span class=p>)</span> <span class=k>return</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>find</span><span class=p>(</span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=nf>merge</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>find</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=n>y</span> <span class=o>=</span> <span class=n>find</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>==</span> <span class=n>y</span><span class=p>)</span> <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>y</span><span class=p>,</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>sets</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=n>LCA</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>fa</span><span class=p>[</span><span class=n>MAX_P</span><span class=p>][</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mx</span><span class=p>[</span><span class=n>MAX_P</span><span class=p>][</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>depth</span><span class=p>[</span><span class=n>MAX_P</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>prep</span><span class=p>(</span><span class=kt>int</span> <span class=n>st</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>st</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>depth</span><span class=p>[</span><span class=n>st</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=p>[</span><span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>]</span> <span class=o>:</span> <span class=n>graph</span><span class=p>[</span><span class=n>u</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>depth</span><span class=p>[</span><span class=n>v</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>depth</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>depth</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>,</span> <span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>fa</span><span class=p>[</span><span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>mx</span><span class=p>[</span><span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>q</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>query</span><span class=p>(</span><span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=kt>int</span> <span class=n>v</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>depth</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>depth</span><span class=p>[</span><span class=n>v</span><span class=p>])</span> <span class=n>std</span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>mxw</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>19</span><span class=p>;</span> <span class=o>~</span><span class=n>i</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>depth</span><span class=p>[</span><span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>]]</span> <span class=o>&gt;=</span> <span class=n>depth</span><span class=p>[</span><span class=n>u</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>mxw</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>mxw</span><span class=p>,</span> <span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                <span class=n>v</span> <span class=o>=</span> <span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>u</span> <span class=o>==</span> <span class=n>v</span><span class=p>)</span> <span class=k>return</span> <span class=n>mxw</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>19</span><span class=p>;</span> <span class=o>~</span><span class=n>i</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>fa</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>mxw</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>({</span><span class=n>mxw</span><span class=p>,</span> <span class=n>mx</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>]});</span>
</span></span><span class=line><span class=cl>                <span class=n>u</span> <span class=o>=</span> <span class=n>fa</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>v</span> <span class=o>=</span> <span class=n>fa</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>mxw</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>({</span><span class=n>mxw</span><span class=p>,</span> <span class=n>mx</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>mx</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=mi>0</span><span class=p>]});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>mxw</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>  <span class=c1>// namespace LCA
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>ios</span><span class=o>::</span><span class=n>sync_with_stdio</span><span class=p>(</span><span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span><span class=p>.</span><span class=n>tie</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>N</span> <span class=o>&gt;&gt;</span> <span class=n>M</span> <span class=o>&gt;&gt;</span> <span class=n>P</span> <span class=o>&gt;&gt;</span> <span class=n>Q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>M</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>map</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>P</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>gov</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>q</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>q</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>]</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>front</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>q</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>tx</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>ty</span> <span class=o>=</span> <span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>tx</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>ty</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>tx</span> <span class=o>&gt;</span> <span class=n>N</span> <span class=o>||</span> <span class=n>ty</span> <span class=o>&gt;</span> <span class=n>M</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>map</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;#&#39;</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>gov</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>gov</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]</span> <span class=o>=</span> <span class=n>gov</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>dist</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>q</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>tx</span><span class=p>,</span> <span class=n>ty</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>gov</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]</span> <span class=o>!=</span> <span class=n>gov</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=n>graph2</span><span class=p>[</span><span class=n>dist</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]</span> <span class=o>+</span> <span class=n>dist</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>]].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>gov</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>],</span> <span class=n>gov</span><span class=p>[</span><span class=n>tx</span><span class=p>][</span><span class=n>ty</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sets</span><span class=p>.</span><span class=n>init</span><span class=p>(</span><span class=n>P</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>w</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>w</span> <span class=o>&lt;</span> <span class=n>N</span> <span class=o>*</span> <span class=n>N</span><span class=p>;</span> <span class=n>w</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=p>[</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>]</span> <span class=o>:</span> <span class=n>graph2</span><span class=p>[</span><span class=n>w</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>sets</span><span class=p>.</span><span class=n>merge</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>graph</span><span class=p>[</span><span class=n>u</span><span class=p>].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>graph</span><span class=p>[</span><span class=n>v</span><span class=p>].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>w</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>P</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>LCA</span><span class=o>::</span><span class=n>depth</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>LCA</span><span class=o>::</span><span class=n>prep</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>Q</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>S</span><span class=p>,</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>S</span> <span class=o>&gt;&gt;</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>sets</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>S</span><span class=p>)</span> <span class=o>!=</span> <span class=n>sets</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>T</span><span class=p>))</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=o>-</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>LCA</span><span class=o>::</span><span class=n>query</span><span class=p>(</span><span class=n>S</span><span class=p>,</span> <span class=n>T</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>),</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h2 id=yet-another-array-counting-problem>Yet Another Array Counting Problem</h2><ul><li>å‡ºå¤„ï¼šCodeforces Round 833</li><li>å®˜æ–¹é¢˜é¢åŠè¯„æµ‹åœ°å€ï¼š<a class=link href=https://codeforces.com/problemset/problem/1748/E target=_blank rel=noopener>Codeforces</a></li><li>ä¸­æ–‡ç¿»è¯‘ï¼š<a class=link href=https://www.luogu.com.cn/problem/CF1748E target=_blank rel=noopener>æ´›è°· RemoteJudge</a></li><li>å‚è€ƒé¢˜è§£ï¼š<a class=link href=https://codeforces.com/blog/entry/108319 target=_blank rel=noopener>Official Editorial</a></li></ul><p>æˆ‘ä»¬ä»¤ $\text{lmax}(i, j)$ è¡¨ç¤ºåŸåºåˆ— $a$ çš„åŒºé—´ $\left[i, j\right]$ ä¸Š leftmost maximum çš„ä½ç½®ã€‚åˆ™å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼Œå³å¯¹äºä»»æ„å­åŒºé—´ $\left[l, r\right]$ï¼Œä»¤ $k = \text{lmax}(l, r)$ï¼Œåˆ™ $a_{\text{lmax}(l, k - 1)} &lt; a_k \leqslant a_{\text{lmax}(k + 1, r)}$ï¼ˆå·¦åŠè¾¹ä¸å–ç­‰å·æ˜¯ç”± leftmost maximum çš„æ€§è´¨å†³å®šçš„ï¼Œè¯·æ³¨æ„è¿™ä¸€ç‚¹åœ¨ä¸‹é¢çš„åˆ†æä»¥åŠä»£ç å®ç°ä¸­çš„ä½“ç°ï¼‰ã€‚</p><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å‘ç° $\text{lmax}$ çš„å–å€¼èŒƒå›´æ˜¯ä»æ›´å°çš„é—®é¢˜è§„æ¨¡è½¬ç§»è¿‡æ¥çš„ï¼Œå¹¶ä¸”ç”±äºæ¯ä¸ªåŒºé—´å†…çš„ $\text{lmax}$ çš„å€¼æ˜¯å¯ä»¥æå‰é¢„å¤„ç†å‡ºæ¥çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»¥å½“å‰é—®é¢˜è§„æ¨¡ $\left[l, r\right]$ çš„ leftmost maximum å€¼ $k = \text{lmax}(l, r)$ ä¸ºä¸­ç‚¹è¿›è¡Œåˆ†æ²»æ¥è§£å†³é—®é¢˜ã€‚</p><p>æˆ‘ä»¬ä»¤ $k = \text{lmax}(l, r)$ï¼Œåˆ™ä»¤ $f(k, j)$ ä¸ºå½“æ»¡è¶³ $b_{\text{lmax}(l, r)} = j$ æ—¶ç»„æˆ $b_l \ldots b_r$ çš„æ–¹æ¡ˆæ•°ã€‚æ¥ä¸‹æ¥æ€è€ƒå¦‚ä½•è½¬ç§»ã€‚é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚æ‰€æœ‰å­åŒºé—´çš„ $\text{lmax}$ éƒ½ä¸ $a$ åºåˆ—ç›¸åŒçš„ $b$ åºåˆ—çš„æ•°é‡ï¼Œå…¶å®è¯´ç™½äº†å°±æ˜¯å¯¹äºæ¯ä¸€ä¸ªç¡®å®šçš„ $a$ åºåˆ—ä¸Šçš„ $\text{lmax}$ï¼Œå°†å…¶åŒæ—¶è§†ä¸º $b$ åºåˆ—åŒä¸€åŒºé—´ä¸Šçš„ $\text{lmax}$ åï¼Œä»¥ $\text{lmax}$ ä¸ºåˆ†ç•Œç‚¹çš„å·¦å³ä¸¤è¾¹çš„æ€»æ–¹æ¡ˆæ•°ä¹‹ç§¯ï¼ˆä¹˜æ³•åŸç†ï¼‰ã€‚ç”±æ­¤å¯ä»¥åˆ†ç±»è®¨è®ºå‡ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>$b_{\text{lmax}(l, r)} = 1$ ä¸”å·¦åŠè¾¹é—®é¢˜è§„æ¨¡ä¸ä¸º $\varnothing$ æ—¶ï¼Œæ ¹æ®å®šä¹‰ï¼Œæ–¹æ¡ˆæ•°ä¸º $0$ï¼›</li><li>$\text{lmax}(l, r) = l$ æ—¶ï¼Œå½“å‰é—®é¢˜è§„æ¨¡çš„å·¦åŠè¾¹ä¸º $\varnothing$ï¼Œæ­¤æ—¶æ–¹æ¡ˆæ•°åªè€ƒè™‘å³åŠè¾¹ï¼›</li><li>$\text{lmax}(l, r) = r$ æ—¶ï¼Œå½“å‰é—®é¢˜è§„æ¨¡çš„å³åŠè¾¹ä¸º $\varnothing$ï¼Œæ­¤æ—¶æ–¹æ¡ˆæ•°åªè€ƒè™‘å·¦åŠè¾¹ï¼›</li><li>$\text{lmax}(l, r)$ çš„å·¦å³åŠè¾¹é—®é¢˜è§„æ¨¡éƒ½ä¸ä¸º $\varnothing$ æ—¶ï¼Œæ­¤æ—¶æ–¹æ¡ˆæ•°ä¸ºå·¦è¾¹æ€»æ–¹æ¡ˆæ•°å’Œå³è¾¹æ€»æ–¹æ¡ˆæ•°çš„ç§¯ï¼›</li><li>$\text{lmax}(l, r)$ çš„å·¦å³åŠè¾¹é—®é¢˜è§„æ¨¡éƒ½ä¸º $\varnothing$ æ—¶ï¼Œæ­¤æ—¶æ–¹æ¡ˆæ•°ä¸º $1$ã€‚</li></ul><p>ä¸ºäº†ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬éœ€è¦éšç€é€’å½’è¿‡ç¨‹ç»´æŠ¤æ€»æ–¹æ¡ˆæ•° $g(k, j) = \sum_{i = 1}^{j}f(k, i)$ã€‚</p><p>ç»¼ä¸Šï¼Œè‹¥ä»¤ $k = \text{lmax}(l, r)$ï¼Œ$lc = \text{lmax}(l, k - 1)$ï¼Œ$rc = \text{lmax}(k + 1, r)$ï¼Œåˆ™æœ‰ï¼š</p><p>$$
f(k, j) =
\begin{cases}
0, \quad &\mathrm{if} ~ {b_{\text{lmax}(l, r)} = 1} \land {k \neq l}\newline
1, \quad &\mathrm{if} ~ {k = l = r} \newline
g(rc, j), \quad &\mathrm{if} ~ {k = l} \newline
g(lc, j - 1), \quad &\mathrm{if} ~ {k = r} \newline
g(lc, j - 1) \cdot g(rc, j), &\mathrm{otherwise.}
\end{cases}
$$</p><p>ä»£ç å®ç°ä¸Šï¼Œ$\text{lmax}$ çš„å‡½æ•°å€¼å¯ä»¥é€šè¿‡çº¿æ®µæ ‘ã€ST è¡¨ç­‰æ•°æ®ç»“æ„å®ç°æŸ¥è¯¢ï¼›å¦ä¸€ä¸ªéœ€è¦å°å¿ƒçš„åœ°æ–¹æ˜¯ä¸èƒ½ä¸€æ¬¡æ€§æŠŠ $f$ å’Œ $g$ æ•°ç»„å¼€æˆé™æ€çš„ï¼Œå› ä¸ºæ‰€éœ€è¦çš„ç©ºé—´å¤ªå¤§äº†ï¼Œåˆä¼šé€ æˆå¾ˆå¤šç©ºé—´æµªè´¹ï¼ˆ$n, m \leqslant 2 \times 10^5$ï¼Œä½† $nm \leqslant 10^6$ï¼‰ï¼Œå› æ­¤éœ€è¦é‡‡ç”¨å¼€ <code>vector</code> ä»£æ›¿çš„æ–¹æ³•è¿›è¡Œæ›¿ä»£ã€‚</p><details><summary>ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨ä»£ç </summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;vector&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;cstring&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define endl &#39;\n&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>i64</span> <span class=o>=</span> <span class=kt>long</span> <span class=kt>long</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=mf>2e5</span> <span class=o>+</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span> <span class=o>+</span> <span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>i64</span><span class=o>&gt;</span> <span class=n>f</span><span class=p>[</span><span class=n>N</span><span class=p>],</span> <span class=n>g</span><span class=p>[</span><span class=n>N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>SparseTable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>tb</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>log2</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>exp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exp</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>exp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>prep</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>lmt</span> <span class=o>=</span> <span class=n>log2</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>tb</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>assign</span><span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>assign</span><span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>lmt</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>;</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>x</span> <span class=o>=</span> <span class=n>tb</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>&gt;=</span> <span class=n>a</span><span class=p>[</span><span class=n>y</span> <span class=o>=</span> <span class=n>tb</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]])</span> <span class=n>tb</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=n>tb</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>max</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>log2</span><span class=p>(</span><span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>x</span> <span class=o>=</span> <span class=n>tb</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>t</span><span class=p>]]</span> <span class=o>&gt;=</span> <span class=n>a</span><span class=p>[</span><span class=n>y</span> <span class=o>=</span> <span class=n>tb</span><span class=p>[</span><span class=n>r</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>t</span><span class=p>]])</span> <span class=k>return</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>ST</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>divide_and_conquer</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span> <span class=kt>int</span> <span class=n>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>l</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>)</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>ST</span><span class=p>.</span><span class=n>max</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>lc</span> <span class=o>=</span> <span class=n>divide_and_conquer</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>mid</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>rc</span> <span class=o>=</span> <span class=n>divide_and_conquer</span><span class=p>(</span><span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>m</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>lc</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=n>f</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=n>f</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>lc</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=o>?</span> <span class=n>g</span><span class=p>[</span><span class=n>lc</span><span class=p>][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>:</span> <span class=mi>1LL</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>rc</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=o>?</span> <span class=n>g</span><span class=p>[</span><span class=n>rc</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>:</span> <span class=mi>1LL</span><span class=p>)</span> <span class=o>%</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>g</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>f</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=n>i</span><span class=p>])</span> <span class=o>%</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mid</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>solve</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ST</span><span class=p>.</span><span class=n>prep</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>divide_and_conquer</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>g</span><span class=p>[</span><span class=n>mid</span><span class=p>][</span><span class=n>m</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ios</span><span class=o>::</span><span class=n>sync_with_stdio</span><span class=p>(</span><span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span><span class=p>.</span><span class=n>tie</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>T</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>T</span><span class=o>--</span><span class=p>)</span> <span class=n>solve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>),</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details></section><footer class=article-footer><section class=article-tags><a href=/tags/%E5%9B%BE%E8%AE%BA/>å›¾è®º</a>
<a href=/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>æ•°æ®ç»“æ„</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/misc-solutions-2/><div class=article-details><h2 class=article-title>æ‚é¢˜é€‰è§£ï¼ˆäºŒï¼‰</h2></div></a></article><article><a href=/p/topological-sorting/><div class=article-details><h2 class=article-title>æ‹“æ‰‘æ’åºåŠå…¶ä¸¤ç§å®ç°</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 Eoin Lee's Blog</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>